<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>記事マップ</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
<script src="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css" rel="stylesheet" />
<style>
	body { margin: 0; padding: 0; }
	#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<style>
#map {
position: fixed;
width: 90%;
}
#features {
width: 10%;
margin-left: 90%;
font-family: sans-serif;
overflow-y: scroll;
background-color: #fafafa;
}
section {
padding: 25px 50px;
line-height: 25px;
border-bottom: 1px solid #ddd;
opacity: 0.25;
font-size: 13px;
}
section.active {
opacity: 1;
}
section:last-child {
border-bottom: none;
margin-bottom: 200px;
}
</style>
 
<div id="map"></div>
<div id="features">
<section id="baker" class="active">
<h3>記事１</h3>
<p>
記事１
</p>
</section>
<section id="aldgate">
<h3>記事２</h3>
<p>
記事2
</p>
</section>
<section id="london-bridge">
<h3>記事3</h3>
<p>
記事3
</p>
</section>
<section id="woolwich">
<h3>記事４</h3>
<p>
記事4
</p>
</section>
<section id="gloucester">
<h3>記事５</h3>
<p>
記事5</p>
</section>
<section id="caulfield-gardens">
<h3>記事6</h3>
<p>
記事6
</p>
</section>
<section id="telegraph">
<h3>記事７</h3>
<p>
記事７
</p>
</section>
<section id="charing-cross">
<h3>記事8</h3>
<p>
記事8
</p>
<small id="citation">
Adapted from
<a href="http://www.gutenberg.org/files/2346/2346-h/2346-h.htm"
>Project Gutenberg</a
>
</small>
</section>
</div>
<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoiMTNtdXJhdGEiLCJhIjoiY2s5cXcwampsMDNwazNmbXQxaWVzamE0NiJ9.wSyFabY45TKJhVRjnAStMQ';
var map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/mapbox/streets-v11',
center: [-0.15591514, 51.51830379],
zoom: 18,
bearing: 27,
pitch: 45
});
 
var chapters = {
'baker': {
center: [-0.15591514, 51.51830379],
zoom: 14,
pitch: 20
},
'aldgate': {
duration: 6000,
center: [-0.07571203, 51.51424049],
zoom: 14,
pitch: 0
},
'london-bridge': {
center: [-0.08533793, 51.50438536],
zoom: 14,
speed: 0.6,
pitch: 40
},
'woolwich': {
center: [0.05991101, 51.48752939],
zoom: 14
},
'gloucester': {
center: [-0.18335806, 51.49439521],
zoom: 14,
pitch: 20,
speed: 0.5
},
'caulfield-gardens': {
center: [-0.19684993, 51.5033856],
zoom: 14
},
'telegraph': {
center: [-0.10669358, 51.51433123],
zoom: 14,
pitch: 40
},
'charing-cross': {
center: [-0.12416858, 51.50779757],
zoom: 14,
pitch: 20
}
};
 
// On every scroll event, check which element is on screen
window.onscroll = function() {
var chapterNames = Object.keys(chapters);
for (var i = 0; i < chapterNames.length; i++) {
var chapterName = chapterNames[i];
if (isElementOnScreen(chapterName)) {
setActiveChapter(chapterName);
break;
}
}
};
 
var activeChapterName = 'baker';
function setActiveChapter(chapterName) {
if (chapterName === activeChapterName) return;
 
map.flyTo(chapters[chapterName]);
 
document.getElementById(chapterName).setAttribute('class', 'active');
document.getElementById(activeChapterName).setAttribute('class', '');
 
activeChapterName = chapterName;
}
 
function isElementOnScreen(id) {
var element = document.getElementById(id);
var bounds = element.getBoundingClientRect();
return bounds.top < window.innerHeight && bounds.bottom > 0;
}
</script>
 
</body>
</html>